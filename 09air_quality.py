# ì£½ìŒì˜ ë¨¼ì§€, ì¿ë¹› ì¬ì•™, ì€ë°€í•œ ì‚´ì¸ì => ë¯¸ì„¸ë¨¼ì§€
# ì„¸ê³„ë³´ê±´ê¸°êµ¬ì— ë”°ë¥´ë©´ 2014ë…„, ì „ì„¸ê³„ì—ì„œ ì•½ 700ë§Œ ëª…ì´ ë¯¸ì„¸ë¨¼ì§€ë¡œ ì¸í•´ ì¡°ê¸° ì‚¬ë§

# 1930ë…„ ë²¨ê¸°ì—ì˜ ë®¤ì¦ˆ ë²¨ë¦¬, 1948ë…„ ë¯¸êµ­ íœì‹¤ë² ì´ë‹ˆì•„ ì£¼ì˜ ë„ë…¸ë¼,
# 1952ë…„ ëŸ°ë˜ ìŠ¤ëª¨ê·¸ ë“± ëŒ€ê·œëª¨ ì¬ë‚œì„ ê²ªìœ¼ë©°
# ëŒ€ê¸°ì˜¤ì—¼ì´ ê±´ê°•ì— ë§‰ëŒ€í•œ í”¼í•´ë¥¼ ë¼ì¹  ìˆ˜ ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ì¸ì§€í•¨í•¨

# ë¨¼ì§€ëŠ” ëŒ€ê¸° ì¤‘ ë– ë‹¤ë‹ˆê±°ë‚˜ í©ë‚ ë ¤ ë‚´ë ¤ì˜¤ëŠ” ì…ììƒì˜ ë¬¼ì§ˆì„ ì˜ë¯¸
# ëŒ€ê¸°ì˜¤ì—¼ ë¬¼ì§ˆì—ëŠ” ê°€ìŠ¤ìƒ ë¬¼ì§ˆê³¼ ì…ììƒ ë¬¼ì§ˆì´ ì¡´ì¬

# ë¯¸ì„¸ë¨¼ì§€, ì´ˆë¯¸ì„¸ë¨¼ì§€ëŠ” ì…ììƒ ë¬¼ì§ˆì„ í¬ê¸°ë³„ë¡œ ì„¸ë¶„í™”í•œ ê²ƒ
# 1990ë…„ëŒ€ì—ëŠ” ì…ìì˜ ì§€ë¦„ì´ 50ë§ˆì´í¬ë¡œë¯¸í„° ì´í•˜ì¸ ì´ë¨¼ì§€(TSP)
# 2000ë…„ëŒ€ì—ëŠ” ì§€ë¦„ì´ 10ë§ˆì´í¬ë¡œë¯¸í„° ì´í•˜ì¸ PM10,
# 2010ë…„ëŒ€ì—ëŠ” ì§€ë¦„ì´ 2.5ë§ˆì´í¬ë¡œë¯¸í„° ì´í•˜ì¸ PM2.5ë¡œ ë‚˜ëˆ”
# => ìš°ë¦¬ë‚˜ë¼ì—ì„œëŠ” í†µìƒì ìœ¼ë¡œ PM10ì„ ë¯¸ì„¸ë¨¼ì§€ë¡œ, PM2.5ë¥¼ ì´ˆë¯¸ì„¸ë¨¼ì§€ë¡œ ë²ˆì—­í•´ ì˜´

# 2016ë…„, 2017ë…„, í™˜ê²½ë¶€ì—ì„œëŠ” í•´ì™¸ì˜ ìš©ì–´ì™€ êµ­ë‚´ì˜ ìš©ì–´ë¥¼ ë§ì¶”ê¸° ìœ„í•´
# PM10ì„ ë¶€ìœ ë¨¼ì§€ë¡œ PM2.5ë¥¼ ë¯¸ì„¸ë¨¼ì§€ë¡œ ìš©ì–´ë¥¼ ì •ë¹„í•¨
# ì´ˆë¯¸ì„¸ë¨¼ì§€ëŠ” PM1 ë˜ëŠ” PM0.1ì„ ê°€ë¦¬í‚¤ëŠ” ë§

# ë¯¸ì„¸ë¨¼ì§€/ì´ˆë¯¸ì„¸ë¨¼ì§€ ë“±ê¸‰ì— ë”°ë¥¸ ì´ëª¨ì§€ ì¶œë ¥
# ë¯¸ì„¸ë¨¼ì§€ : ~30 ~80 ~150 151~
# ì´ˆë¯¸ì„¸ë¨¼ì§€ : ~15 ~35 ~75 76~
# ğŸ˜€ ğŸ˜ ğŸ˜« ğŸ˜±

# ì‹œë„ë³„ ì‹¤ì‹œê°„ ëŒ€ê¸°ì˜¤ì—¼ì •ë³´ ì¡°íšŒ
# ì§€ì—­ì„ ì…ë ¥í•˜ë©´ ì¸¡ì •ì†Œëª…stationName, ì¸¡ì •ì¼ì‹œdataTime,
# ë¯¸ì„¸ë¨¼ì§€(PM10)ë†ë„pm10Value, ì´ˆë¯¸ì„¸ë¨¼ì§€(PM25)ë†ë„pm25Value ì¶œë ¥
import requests
from bs4 import BeautifulSoup

url = 'http://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getCtprvnRltmMesureDnsty'
returnType = 'xml'
params = {'serviceKey':'GjgjTYLP10LmklhSDVDE6qQ8KZPc43DI%2BJ0iaotwuQpc5cFzNY19Uo269sO%2F5MQJ%2BGT6AmPGbn3prlagN3nf7A%3D%3D',
         'returnType':returnType,'sidoName':'ì „êµ­','pageNo':1, 'numOfRows':10000, 'ver':'1.0'}

res = requests.get(url,params=params)
html = BeautifulSoup(res.text,'lxml')

# ì´ˆë¯¸ì„¸ë¨¼ì§€, ë¯¸ì„¸ë¨¼ì§€ ì •ë³´ ì¶”ì¶œ
for item in html.select('item'):
    if item.stationname.text == 'ë§ˆí¬êµ¬':
        pm10v = item.pm10value.text
        pm25v = item.pm25value.text
        print(item.stationname.text,item.datatime.text, pm10v,pm10(int(pm10v)),pm25v,pm25(int(pm25v)))

city, pm10_r, pm25_r = [],[],[]
for item in html.select('item'):
    city.append(item.stationname.text)
    pm10_r.append(item.pm10value.text)
    pm25_r.append(item.pm25value.text)

# ë¯¸ì„¸ë¨¼ì§€, ì´ˆë¯¸ì„¸ë¨¼ì§€ ë“±ê¸‰ë¶€ì—¬
# ë¯¸ì„¸ë¨¼ì§€/ì´ˆë¯¸ì„¸ë¨¼ì§€ ë“±ê¸‰ì— ë”°ë¥¸ ì´ëª¨ì§€ ì¶œë ¥
# ë¯¸ì„¸ë¨¼ì§€ : 30, ~80, ~150, 151
# ì´ˆë¯¸ì„¸ë¨¼ì§€ : 15, ~35, ~75, 76
# ğŸ˜€ ğŸ˜ ğŸ˜« ğŸ˜±

def pm10(val):
    grade = 'ğŸ˜€'
    if val <= 30:
        grade = 'ğŸ˜€'
    elif 30 < val <= 80:
        grade = 'ğŸ˜'
    elif 80 < val <= 150:
        grade = 'ğŸ˜«'
    else:
        grade = 'ğŸ˜±'

    return grade


def pm25(val):
    grade = 'ğŸ˜€'
    if val <= 15:
        grade = 'ğŸ˜€'
    elif 15 < val <= 35:
        grade = 'ğŸ˜'
    elif 35 < val <= 75:
        grade = 'ğŸ˜«'
    else:
        grade = 'ğŸ˜±'
    return grade

# ëŒ€ê¸°ì˜¤ì—¼ì •ë³´ë¥¼ JSONìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ê¸°
import json
returnType = 'json'
params = {'serviceKey':'GjgjTYLP10LmklhSDVDE6qQ8KZPc43DI%2BJ0iaotwuQpc5cFzNY19Uo269sO%2F5MQJ%2BGT6AmPGbn3prlagN3nf7A%3D%3D',
         'returnType':returnType,'sidoName':'ì „êµ­','pageNo':1, 'numOfRows':10000, 'ver':'1.0'}

res = requests.get(url,params=params)

# í…ìŠ¤íŠ¸ë¡œ êµ¬ì„±ëœ json ë¬¸ìì—´ì„ ê°ì²´ë¡œ ë³€í™˜
json_data = json.loads(res.text)

# jsonì—ì„œ ê°ì²´ì˜ ì†ì„± í˜¸ì¶œ : ê°ì²´ëª…['ì†ì„±ëª…'], ê°ì²´ëª….ì†ì„±ëª…
for item in json_data['response']['body']['items']:
    if item['stationName'] == 'ë§ˆí¬êµ¬':
        pm10v = item['pm10Value']
        pm25v = item['pm25Value']
        print(item['stationName'], item['dataTime'], pm10v,pm10(int(pm10v)),pm25v,pm25(int(pm25v)))